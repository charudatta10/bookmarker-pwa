<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bookmarker - A modern PWA for organizing and managing bookmarks">
    <meta name="theme-color" content="#4285f4">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Bookmarker">
    
    <title>Bookmarker</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    
    <!-- Material Icons from CDN -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="icons/favicon.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
</head>
<body>
    <header class="app-header">
        <div class="header-content">
            <button id="menu-toggle" class="icon-button" aria-label="Toggle menu">
                <span class="material-icons">menu</span>
            </button>
            <h1 class="app-title">Bookmarker</h1>
            <div class="header-actions">
                <button id="search-toggle" class="icon-button" aria-label="Search">
                    <span class="material-icons">search</span>
                </button>
                <button id="add-bookmark" class="icon-button" aria-label="Add bookmark">
                    <span class="material-icons">add</span>
                </button>
            </div>
        </div>
        
        <div id="search-container" class="search-container hidden">
            <div class="search-input-wrapper">
                <span class="material-icons">search</span>
                <input type="text" id="search-input" placeholder="Search bookmarks..." aria-label="Search bookmarks">
                <button id="clear-search" class="icon-button" aria-label="Clear search">
                    <span class="material-icons">close</span>
                </button>
            </div>
        </div>
    </header>

    <div class="app-container">
        <nav id="side-nav" class="side-nav">
            <div class="nav-header">
                <h2>Categories</h2>
                <button id="add-category" class="icon-button" aria-label="Add category">
                    <span class="material-icons">add</span>
                </button>
            </div>
            <ul id="category-list" class="category-list">
                <li class="category-item active" data-category="all">
                    <span class="material-icons">bookmarks</span>
                    <span class="category-name">All Bookmarks</span>
                    <span class="bookmark-count">0</span>
                </li>
                <li class="category-item" data-category="uncategorized">
                    <span class="material-icons">label_off</span>
                    <span class="category-name">Uncategorized</span>
                    <span class="bookmark-count">0</span>
                </li>
                <!-- Categories will be dynamically added here -->
            </ul>
            
            <div class="nav-footer">
                <button id="settings-button" class="nav-button">
                    <span class="material-icons">settings</span>
                    <span>Settings</span>
                </button>
                <button id="import-export-button" class="nav-button">
                    <span class="material-icons">import_export</span>
                    <span>Import/Export</span>
                </button>
            </div>
        </nav>

        <main id="main-content" class="main-content">
            <div id="home-view" class="view active">
                <div class="view-header">
                    <h2 id="current-view-title">All Bookmarks</h2>
                    <div class="view-actions">
                        <button id="sort-button" class="icon-button" aria-label="Sort">
                            <span class="material-icons">sort</span>
                        </button>
                        <div class="view-toggle">
                            <button id="grid-view-button" class="icon-button active" aria-label="Grid view">
                                <span class="material-icons">grid_view</span>
                            </button>
                            <button id="list-view-button" class="icon-button" aria-label="List view">
                                <span class="material-icons">view_list</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="bookmarks-container" class="bookmarks-container grid-view">
                    <!-- Bookmarks will be dynamically added here -->
                    <div class="empty-state">
                        <span class="material-icons">bookmark_border</span>
                        <h3>No bookmarks yet</h3>
                        <p>Add your first bookmark by clicking the + button</p>
                    </div>
                </div>
            </div>
            
            <!-- Other views will be dynamically loaded -->
            <div id="bookmark-detail-view" class="view hidden"></div>
            <div id="settings-view" class="view hidden">
                <div class="view-header">
                    <h2>Settings</h2>
                </div>
                <div class="settings-container">
                    <div class="settings-section">
                        <h3>Appearance</h3>
                        <div class="setting-item">
                            <span>Theme</span>
                            <div class="theme-toggle">
                                <button id="light-theme-btn" class="theme-btn">Light</button>
                                <button id="dark-theme-btn" class="theme-btn">Dark</button>
                                <button id="system-theme-btn" class="theme-btn active">System</button>
                            </div>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>Storage</h3>
                        <div class="setting-item">
                            <span>Database Size</span>
                            <span id="database-size">0 KB</span>
                        </div>
                        <div class="setting-item">
                            <button id="clear-data-btn" class="button danger">Clear All Data</button>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>About</h3>
                        <div class="setting-item">
                            <span>Version</span>
                            <span>1.0.0</span>
                        </div>
                        <div class="setting-item">
                            <span>Storage Type</span>
                            <span>SQLite (WebAssembly)</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="import-export-view" class="view hidden">
                <div class="view-header">
                    <h2>Import/Export</h2>
                </div>
                <div class="import-export-container">
                    <div class="import-section">
                        <h3>Import Bookmarks</h3>
                        <p>Import bookmarks from a file or browser</p>
                        <div class="import-options">
                            <button id="import-file-btn" class="button primary">
                                <span class="material-icons">upload_file</span>
                                Import from File
                            </button>
                            <button id="import-browser-btn" class="button secondary">
                                <span class="material-icons">language</span>
                                Import from Browser
                            </button>
                        </div>
                        <input type="file" id="import-file-input" accept=".json,.html" hidden>
                    </div>
                    <div class="export-section">
                        <h3>Export Bookmarks</h3>
                        <p>Export your bookmarks to a file</p>
                        <div class="export-options">
                            <button id="export-json-btn" class="button primary">
                                <span class="material-icons">code</span>
                                Export as JSON
                            </button>
                            <button id="export-html-btn" class="button secondary">
                                <span class="material-icons">html</span>
                                Export as HTML
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal templates -->
    <div id="modal-container" class="modal-container hidden">
        <div class="modal-backdrop"></div>
        
        <!-- Add/Edit Bookmark Modal -->
        <div id="bookmark-modal" class="modal hidden" aria-labelledby="bookmark-modal-title" aria-modal="true">
            <div class="modal-header">
                <h3 id="bookmark-modal-title">Add Bookmark</h3>
                <button class="icon-button close-modal" aria-label="Close">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-content">
                <form id="bookmark-form">
                    <div class="form-group">
                        <label for="bookmark-url">URL</label>
                        <input type="url" id="bookmark-url" required placeholder="https://example.com">
                    </div>
                    <div class="form-group">
                        <label for="bookmark-title">Title</label>
                        <input type="text" id="bookmark-title" required placeholder="Website Title">
                    </div>
                    <div class="form-group">
                        <label for="bookmark-description">Description (optional)</label>
                        <textarea id="bookmark-description" rows="3" placeholder="Add a description..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="bookmark-categories">Categories</label>
                        <div class="categories-container" id="bookmark-categories-container">
                            <!-- Categories will be dynamically added here -->
                        </div>
                        <button type="button" id="add-new-category" class="text-button">
                            <span class="material-icons">add</span>
                            Add new category
                        </button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="button secondary close-modal">Cancel</button>
                <button type="button" id="save-bookmark" class="button primary">Save</button>
            </div>
        </div>
        
        <!-- Add Category Modal -->
        <div id="category-modal" class="modal hidden" aria-labelledby="category-modal-title" aria-modal="true">
            <div class="modal-header">
                <h3 id="category-modal-title">Add Category</h3>
                <button class="icon-button close-modal" aria-label="Close">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-content">
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">Name</label>
                        <input type="text" id="category-name" required placeholder="Category Name">
                    </div>
                    <div class="form-group">
                        <label for="category-color">Color</label>
                        <input type="color" id="category-color" value="#4285f4">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="button secondary close-modal">Cancel</button>
                <button type="button" id="save-category" class="button primary">Save</button>
            </div>
        </div>
    </div>

    <!-- Toast notification -->
    <div id="toast" class="toast hidden" role="alert" aria-live="polite"></div>

    <!-- Offline indicator -->
    <div id="offline-indicator" class="offline-indicator hidden">
        <span class="material-icons">cloud_off</span>
        <span>You are offline</span>
    </div>

    <!-- Loading indicator -->
    <div id="loading-indicator" class="loading-indicator hidden">
        <div class="spinner"></div>
    </div>

    <!-- Register service worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
    
    <!-- Direct inline script for button functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Modal management
            let modalStack = [];
            
            // Show toast notification
            function showToast(message, duration = 3000) {
                const toast = document.getElementById('toast');
                if (toast) {
                    toast.textContent = message;
                    toast.classList.remove('hidden');
                    
                    // Hide after duration
                    setTimeout(() => {
                        toast.classList.add('hidden');
                    }, duration);
                    
                    console.log('Toast shown:', message);
                }
            }
            
            // Toggle menu
            function toggleMenu() {
                const appContainer = document.querySelector('.app-container');
                if (appContainer) {
                    appContainer.classList.toggle('nav-open');
                    console.log('Menu toggled');
                }
            }
            
            // Toggle search
            function toggleSearch(forceOpen = false) {
                const searchContainer = document.getElementById('search-container');
                if (searchContainer) {
                    if (forceOpen) {
                        searchContainer.classList.remove('hidden');
                    } else {
                        searchContainer.classList.toggle('hidden');
                    }
                    
                    if (!searchContainer.classList.contains('hidden')) {
                        const searchInput = document.getElementById('search-input');
                        if (searchInput) {
                            searchInput.focus();
                        }
                    }
                    
                    console.log('Search toggled');
                }
            }
            
            // Clear search
            function clearSearch() {
                const searchInput = document.getElementById('search-input');
                if (searchInput) {
                    searchInput.value = '';
                    searchInput.focus();
                }
                
                console.log('Search cleared');
            }
            
            // Show add bookmark modal
            function showAddBookmarkModal() {
                const modalContainer = document.getElementById('modal-container');
                const bookmarkModal = document.getElementById('bookmark-modal');
                
                if (modalContainer && bookmarkModal) {
                    modalContainer.classList.remove('hidden');
                    bookmarkModal.classList.remove('hidden');
                    
                    // Set modal title
                    const modalTitle = bookmarkModal.querySelector('#bookmark-modal-title');
                    if (modalTitle) {
                        modalTitle.textContent = 'Add Bookmark';
                    }
                    
                    // Reset form
                    const bookmarkForm = document.getElementById('bookmark-form');
                    if (bookmarkForm) {
                        bookmarkForm.reset();
                    }
                    
                    // Add to modal stack
                    modalStack.push('bookmark');
                    
                    console.log('Add bookmark modal shown');
                }
            }
            
            // Show add category modal
            function showAddCategoryModal(fromBookmarkForm = false) {
                const modalContainer = document.getElementById('modal-container');
                const categoryModal = document.getElementById('category-modal');
                
                if (modalContainer && categoryModal) {
                    // If called from bookmark form, store current modal
                    if (fromBookmarkForm) {
                        // Store that we came from bookmark form
                        categoryModal.dataset.fromBookmarkForm = 'true';
                    } else {
                        delete categoryModal.dataset.fromBookmarkForm;
                    }
                    
                    modalContainer.classList.remove('hidden');
                    categoryModal.classList.remove('hidden');
                    
                    // Set modal title
                    const modalTitle = categoryModal.querySelector('#category-modal-title');
                    if (modalTitle) {
                        modalTitle.textContent = 'Add Category';
                    }
                    
                    // Reset form
                    const categoryForm = document.getElementById('category-form');
                    if (categoryForm) {
                        categoryForm.reset();
                        
                        // Set random color
                        const colorInput = categoryForm.querySelector('#category-color');
                        if (colorInput) {
                            const colors = [
                                '#4285f4', '#34a853', '#fbbc05', '#ea4335', 
                                '#673ab7', '#3f51b5', '#2196f3', '#009688', 
                                '#4caf50', '#ff9800', '#ff5722', '#795548', '#607d8b'
                            ];
                            colorInput.value = colors[Math.floor(Math.random() * colors.length)];
                        }
                    }
                    
                    // Add to modal stack
                    modalStack.push('category');
                    
                    console.log('Add category modal shown');
                }
            }
            
            // Close current modal
            function closeCurrentModal() {
                const modalContainer = document.getElementById('modal-container');
                const modals = document.querySelectorAll('.modal');
                
                if (modalContainer && modals.length > 0) {
                    // Get current modal from stack
                    const currentModal = modalStack.pop();
                    
                    if (currentModal) {
                        // Hide current modal
                        const modalElement = document.getElementById(`${currentModal}-modal`);
                        if (modalElement) {
                            modalElement.classList.add('hidden');
                        }
                    }
                    
                    // If no more modals in stack, hide container
                    if (modalStack.length === 0) {
                        modalContainer.classList.add('hidden');
                    }
                    
                    console.log('Modal closed');
                }
            }
            
            // Save bookmark
            function saveBookmark() {
                // In a real app, this would save to the database
                showToast('Bookmark saved');
                closeCurrentModal();
                console.log('Bookmark saved');
            }
            
            // Save category
            function saveCategory() {
                // In a real app, this would save to the database
                showToast('Category saved');
                
                const categoryModal = document.getElementById('category-modal');
                const fromBookmarkForm = categoryModal && categoryModal.dataset.fromBookmarkForm === 'true';
                
                closeCurrentModal();
                
                // If called from bookmark form, reopen bookmark modal
                if (fromBookmarkForm) {
                    showAddBookmarkModal();
                }
                
                console.log('Category saved');
            }
            
            // Show view
            function showView(viewId) {
                const views = document.querySelectorAll('.view');
                views.forEach(view => {
                    view.classList.add('hidden');
                    view.classList.remove('active');
                });
                
                const view = document.getElementById(viewId);
                if (view) {
                    view.classList.remove('hidden');
                    view.classList.add('active');
                }
                
                // Update current view title
                const viewTitle = document.getElementById('current-view-title');
                if (viewTitle) {
                    switch (viewId) {
                        case 'settings-view':
                            viewTitle.textContent = 'Settings';
                            break;
                        case 'import-export-view':
                            viewTitle.textContent = 'Import/Export';
                            break;
                        default:
                            viewTitle.textContent = 'All Bookmarks';
                    }
                }
            }
            
            // Set view mode
            function setViewMode(mode) {
                const bookmarksContainer = document.getElementById('bookmarks-container');
                const gridViewBtn = document.getElementById('grid-view-button');
                const listViewBtn = document.getElementById('list-view-button');
                
                if (bookmarksContainer && gridViewBtn && listViewBtn) {
                    if (mode === 'grid') {
                        bookmarksContainer.classList.add('grid-view');
                        bookmarksContainer.classList.remove('list-view');
                        gridViewBtn.classList.add('active');
                        listViewBtn.classList.remove('active');
                    } else {
                        bookmarksContainer.classList.add('list-view');
                        bookmarksContainer.classList.remove('grid-view');
                        listViewBtn.classList.add('active');
                        gridViewBtn.classList.remove('active');
                    }
                    
                    // Save preference
                    localStorage.setItem('viewMode', mode);
                    
                    console.log('View mode set to:', mode);
                }
            }
            
            // Show sort options
            function showSortOptions() {
                // In a real app, this would show a dropdown or modal with sort options
                // For now, we'll just cycle through sort options
                const sortOptions = ['date-added', 'title', 'most-visited'];
                const currentSort = localStorage.getItem('sortBy') || 'date-added';
                
                // Get next sort option
                const currentIndex = sortOptions.indexOf(currentSort);
                const nextIndex = (currentIndex + 1) % sortOptions.length;
                const nextSort = sortOptions[nextIndex];
                
                // Save preference
                localStorage.setItem('sortBy', nextSort);
                
                // Show toast
                let sortName;
                switch (nextSort) {
                    case 'date-added':
                        sortName = 'Date Added';
                        break;
                    case 'title':
                        sortName = 'Title';
                        break;
                    case 'most-visited':
                        sortName = 'Most Visited';
                        break;
                    default:
                        sortName = 'Date Added';
                }
                
                showToast(`Sorted by: ${sortName}`);
                
                console.log('Sort changed to:', nextSort);
            }
            
            // Select category
            function selectCategory(categoryId) {
                const categoryItems = document.querySelectorAll('.category-item');
                categoryItems.forEach(item => {
                    item.classList.toggle('active', item.dataset.category === categoryId);
                });
                
                // Update current view title
                const viewTitle = document.getElementById('current-view-title');
                if (viewTitle) {
                    if (categoryId === 'all') {
                        viewTitle.textContent = 'All Bookmarks';
                    } else if (categoryId === 'uncategorized') {
                        viewTitle.textContent = 'Uncategorized';
                    } else {
                        // In a real app, we would get the category name from the database
                        const categoryItem = document.querySelector(`.category-item[data-category="${categoryId}"]`);
                        if (categoryItem) {
                            const categoryName = categoryItem.querySelector('.category-name');
                            if (categoryName) {
                                viewTitle.textContent = categoryName.textContent;
                            }
                        }
                    }
                }
                
                console.log('Category selected:', categoryId);
            }
            
            // Initialize theme from preferences
            function initTheme() {
                const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
                const savedTheme = localStorage.getItem('theme');
                
                if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
                    document.body.classList.add('dark-theme');
                }
            }
            
            // Initialize view mode from preferences
            function initViewMode() {
                const savedViewMode = localStorage.getItem('viewMode') || 'grid';
                setViewMode(savedViewMode);
            }
            
            // Check for online/offline status
            function updateOnlineStatus() {
                const offlineIndicator = document.getElementById('offline-indicator');
                if (offlineIndicator) {
                    if (navigator.onLine) {
                        offlineIndicator.classList.add('hidden');
                    } else {
                        offlineIndicator.classList.remove('hidden');
                    }
                }
            }
            
            // Initialize event listeners
            function initEventListeners() {
                // Menu toggle
                const menuToggle = document.getElementById('menu-toggle');
                if (menuToggle) {
                    menuToggle.addEventListener('click', toggleMenu);
                }
                
                // Search toggle
                const searchToggle = document.getElementById('search-toggle');
                if (searchToggle) {
                    searchToggle.addEventListener('click', () => toggleSearch());
                }
                
                // Add bookmark button
                const addBookmarkBtn = document.getElementById('add-bookmark');
                if (addBookmarkBtn) {
                    addBookmarkBtn.addEventListener('click', showAddBookmarkModal);
                }
                
                // Add category button
                const addCategoryBtn = document.getElementById('add-category');
                if (addCategoryBtn) {
                    addCategoryBtn.addEventListener('click', () => showAddCategoryModal());
                }
                
                // Settings button
                const settingsBtn = document.getElementById('settings-button');
                if (settingsBtn) {
                    settingsBtn.addEventListener('click', () => showView('settings-view'));
                }
                
                // Import/Export button
                const importExportBtn = document.getElementById('import-export-button');
                if (importExportBtn) {
                    importExportBtn.addEventListener('click', () => showView('import-export-view'));
                }
                
                // View toggle buttons
                const gridViewBtn = document.getElementById('grid-view-button');
                const listViewBtn = document.getElementById('list-view-button');
                
                if (gridViewBtn) {
                    gridViewBtn.addEventListener('click', () => setViewMode('grid'));
                }
                
                if (listViewBtn) {
                    listViewBtn.addEventListener('click', () => setViewMode('list'));
                }
                
                // Sort button
                const sortBtn = document.getElementById('sort-button');
                if (sortBtn) {
                    sortBtn.addEventListener('click', showSortOptions);
                }
                
                // Modal close buttons
                const closeButtons = document.querySelectorAll('.close-modal');
                closeButtons.forEach(button => {
                    button.addEventListener('click', closeCurrentModal);
                });
                
                // Modal backdrop
                const modalBackdrop = document.querySelector('.modal-backdrop');
                if (modalBackdrop) {
                    modalBackdrop.addEventListener('click', closeCurrentModal);
                }
                
                // Save bookmark button
                const saveBookmarkBtn = document.getElementById('save-bookmark');
                if (saveBookmarkBtn) {
                    saveBookmarkBtn.addEventListener('click', saveBookmark);
                }
                
                // Save category button
                const saveCategoryBtn = document.getElementById('save-category');
                if (saveCategoryBtn) {
                    saveCategoryBtn.addEventListener('click', saveCategory);
                }
                
                // Add new category button in bookmark form
                const addNewCategoryBtn = document.getElementById('add-new-category');
                if (addNewCategoryBtn) {
                    addNewCategoryBtn.addEventListener('click', () => showAddCategoryModal(true));
                }
                
                // Category list items
                const categoryItems = document.querySelectorAll('.category-item');
                categoryItems.forEach(item => {
                    item.addEventListener('click', () => selectCategory(item.dataset.category));
                });
                
                // Clear search button
                const clearSearchBtn = document.getElementById('clear-search');
                if (clearSearchBtn) {
                    clearSearchBtn.addEventListener('click', clearSearch);
                }
                
                // Theme buttons
                const lightThemeBtn = document.getElementById('light-theme-btn');
                const darkThemeBtn = document.getElementById('dark-theme-btn');
                const systemThemeBtn = document.getElementById('system-theme-btn');
                
                if (lightThemeBtn) {
                    lightThemeBtn.addEventListener('click', () => {
                        document.body.classList.remove('dark-theme');
                        localStorage.setItem('theme', 'light');
                        updateThemeButtons('light');
                    });
                }
                
                if (darkThemeBtn) {
                    darkThemeBtn.addEventListener('click', () => {
                        document.body.classList.add('dark-theme');
                        localStorage.setItem('theme', 'dark');
                        updateThemeButtons('dark');
                    });
                }
                
                if (systemThemeBtn) {
                    systemThemeBtn.addEventListener('click', () => {
                        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
                        if (prefersDarkScheme.matches) {
                            document.body.classList.add('dark-theme');
                        } else {
                            document.body.classList.remove('dark-theme');
                        }
                        localStorage.removeItem('theme');
                        updateThemeButtons('system');
                    });
                }
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    // Escape key closes modals
                    if (e.key === 'Escape') {
                        closeCurrentModal();
                    }
                    
                    // Ctrl+K or Cmd+K for search
                    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                        e.preventDefault();
                        toggleSearch(true); // true forces open
                    }
                });
                
                // Online/offline events
                window.addEventListener('online', updateOnlineStatus);
                window.addEventListener('offline', updateOnlineStatus);
            }
            
            // Update theme buttons
            function updateThemeButtons(theme) {
                const lightThemeBtn = document.getElementById('light-theme-btn');
                const darkThemeBtn = document.getElementById('dark-theme-btn');
                const systemThemeBtn = document.getElementById('system-theme-btn');
                
                if (lightThemeBtn && darkThemeBtn && systemThemeBtn) {
                    lightThemeBtn.classList.toggle('active', theme === 'light');
                    darkThemeBtn.classList.toggle('active', theme === 'dark');
                    systemThemeBtn.classList.toggle('active', theme === 'system');
                }
            }
            
            // Initialize application
            function initApp() {
                initTheme();
                initViewMode();
                initEventListeners();
                updateOnlineStatus();
                console.log('Application initialized');
            }
            
            // Start the application
            initApp();
        });
    </script>
</body>
</html>
